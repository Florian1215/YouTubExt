(()=>{"use strict";(()=>{let e,t=chrome;function n(n,o=null,r=[]){e.get(o,(c=>{t.runtime.lastError?(e=t.storage.local,e.get(o,(e=>{n(e,...r)}))):n(c,...r)}))}const o=("object"==typeof browser&&"object"==typeof browser.runtime&&(t=browser),e=t.storage.local,"object"==typeof t.storage.sync&&(e=t.storage.sync),t),r=document.documentElement;function c(e){Object.keys(e).forEach((t=>{-1!==t.indexOf("hide")&&r.setAttribute(t,e[t])}))}function i(e){!0===e.yt_on&&c(e),function(){if(!document.getElementById("unhook-yt")){const e=document.createElement("script");e.src=o.runtime.getURL("js/unhook-yt.js"),e.id="unhook-yt",r.appendChild(e)}}(),function(){if(!document.getElementById("unhook-download-buttons-script")){const e=document.createElement("script");e.src=o.runtime.getURL("js/download-buttons.js"),e.id="unhook-download-buttons-script",r.appendChild(e)}}(),d()}function u(e){Object.keys(e).forEach((e=>{-1!==e.indexOf("hide")&&r.removeAttribute(e)}))}function s(){n(i),o.storage.onChanged.addListener((e=>{Object.prototype.hasOwnProperty.call(e,"yt_on")?e.yt_on.newValue?n(c):n(u):Object.keys(e).forEach((t=>{-1!==t.indexOf("hide")&&r.setAttribute(t,e[t].newValue)}))}))}function d(){if(window.__unhookDownloadBridge)return;window.__unhookDownloadBridge=!0,window.addEventListener("message",(function(e){if(e.source!==window)return;const t=e.data;if(!t||!t.direction)return;if("unhook-download-request"===t.direction){const r=t.payload||{};if(!r.requestId)return void window.postMessage({direction:"unhook-download-response",payload:{requestId:null,success:!1,error:"missing requestId"}},"*");let i=!1;const c=function(e,t){i||(i=!0,window.postMessage({direction:"unhook-download-response",payload:{requestId:r.requestId,success:!t&&e&&e.success,error:t||e&&e.error,message:e&&e.message,jobId:e&&e.jobId||null}},"*"))};try{const e=o.runtime.sendMessage({type:"unhook-download",payload:r},(function(e){const t=o.runtime.lastError;c(e,t&&t.message)}));e&&"function"==typeof e.then&&(e.then((function(e){c(e,null)})).catch((function(e){c(null,e&&e.message?e.message:String(e))})))}catch(e){c(null,e&&e.message?e.message:String(e))}}else if("unhook-download-status-request"===t.direction){const r=t.payload||{},i=r.requestId,c=r.jobId;if(!i)return void window.postMessage({direction:"unhook-download-status-response",payload:{requestId:null,success:!1,error:"missing requestId"}},"*");if(!c)return void window.postMessage({direction:"unhook-download-status-response",payload:{requestId:i,success:!1,error:"missing jobId"}},"*");let d=!1;const l=function(e,t){d||(d=!0,window.postMessage({direction:"unhook-download-status-response",payload:{requestId:i,success:!t&&e&&e.success!==!1,status:e&&e.status||null,progress:"number"==typeof e.progress?e.progress:null,message:e&&e.message||null,error:t||e&&e.error||null}},"*"))};try{const e=o.runtime.sendMessage({type:"unhook-download-status",requestId:i,jobId:c},(function(e){const t=o.runtime.lastError;l(e,t&&t.message)}));e&&"function"==typeof e.then&&(e.then((function(e){l(e,null)})).catch((function(e){l(null,e&&e.message?e.message:String(e))})))}catch(e){l(null,e&&e.message?e.message:String(e))}}}),!1)}document.unhookRunning||(document.unhookRunning=!0,window===window.parent?s():window.addEventListener("DOMContentLoaded",(()=>{document.getElementById("player")&&s()})))})()})();